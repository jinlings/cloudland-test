{"ast":null,"code":"var _jsxFileName = \"/Users/emily/cloudland/src/pages/instances/Instances.jsx\";\n\n/*\n\nCopyright <holder> All Rights Reserved\n\nSPDX-License-Identifier: Apache-2.0\n\n*/\nimport React, { Component } from \"react\";\nimport { Card, Table, Button, Popconfirm, Pagination, Row, Col, Menu, Dropdown, message, Modal } from \"antd\";\nimport { insListApi, delInsInfor, getInsInforById, editInsInfor } from \"../../service/instances\";\nimport DataTable from \"../../components/DataTable/DataTable\";\nimport InstModal from \"./InstModal\";\nimport \"./instances.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Instances extends Component {\n  constructor(props) {\n    super(props);\n    this.columns = [{\n      title: \"ID\",\n      key: \"ID\",\n      width: 60,\n      align: \"center\",\n      dataIndex: \"ID\"\n    }, {\n      title: \"HostName\",\n      dataIndex: \"Hostname\",\n      align: \"center\"\n    }, {\n      title: \"Flavor\",\n      dataIndex: \"Flavor.Name\",\n      align: \"center\"\n    }, {\n      title: \"Image\",\n      dataIndex: \"Image.Name\",\n      align: \"center\"\n    }, {\n      title: \"IP Address\",\n      dataIndex: \"Interfaces\",\n      key: Math.random(),\n      align: \"center\",\n      render: Interfaces => /*#__PURE__*/_jsxDEV(\"span\", {\n        children: Interfaces.map(iface => {\n          return iface.Address.Address + \" \";\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this)\n    }, {\n      title: \"Console\",\n      dataIndex: \"\",\n      align: \"center\"\n    }, {\n      title: \"Status\",\n      dataIndex: \"Status\",\n      align: \"center\"\n    }, {\n      title: \"Hyper\",\n      dataIndex: \"Hyper\",\n      align: \"center\"\n    }, {\n      title: \"Owner\",\n      dataIndex: \"Interfaces\",\n      align: \"center\",\n      render: console.log(\"interface:\", this.state.instances) // render: (Interfaces) => (\n      //   <span>\n      //     {Interfaces.map((iface) => {\n      //       return iface.Secgroups[0].Name;\n      //     })}\n      //   </span>\n      // ),\n\n    }, {\n      title: \"Zone\",\n      dataIndex: \"Zone.Name\",\n      align: \"center\"\n    }, {\n      title: \"Action\",\n      align: \"center\",\n      render: (txt, record, index) => {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"actionStyle\",\n          children: [/*#__PURE__*/_jsxDEV(Dropdown.Button, {\n            type: \"primary\",\n            onClick: () => {\n              console.log(\"onClick:\", record);\n              this.props.history.push(\"/instances/new/\" + record.ID);\n            },\n            overlay: this.menu(record.ID),\n            children: \"Edit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Popconfirm, {\n            title: \"Are you sure to delete?\",\n            onCancel: () => {\n              console.log(\"cancelled\");\n            },\n            onConfirm: () => {\n              console.log(\"onClick-delete:\", record);\n              delInsInfor(record.ID).then(res => {\n                message.success(res.Msg);\n                this.loadData(this.state.current, this.state.pageSize);\n                console.log(\"用户~~\", res);\n                console.log(\"用户~~state\", this.state);\n              });\n            },\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              style: {\n                margin: \"5px\",\n                marginRight: \"0px\",\n                marginTop: \"10px\",\n                height: \"32px\"\n              },\n              type: \"danger\",\n              size: \"small\",\n              children: \"Delete\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 155,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }, this);\n      }\n    }];\n\n    this.menu = r => /*#__PURE__*/_jsxDEV(Menu, {\n      onClick: this.handleModal.bind(this, r),\n      children: [/*#__PURE__*/_jsxDEV(Menu.Item, {\n        children: \"Change Hostname\"\n      }, \"changeHostname\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Menu.Item, {\n        children: \"Migrate Instance\"\n      }, \"migrateIns\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Menu.Item, {\n        children: \"Resize Instance\"\n      }, \"resizeIns\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Menu.Item, {\n        children: \"Change Status\"\n      }, \"changeStatus\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Menu.Item, {\n        children: \"Start VM\"\n      }, \"startVm\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(Menu.Item, {\n        children: \"Stop VM\"\n      }, \"stopVm\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 5\n    }, this);\n\n    this.handleModal = (id, {\n      key\n    }) => {\n      console.log(\"handleModal-key\", key);\n      this.handleChange(id);\n      console.log(\"handleModal\", id);\n\n      if (key === \"changeHostname\" || key === \"migrateIns\" || key === \"resizeIns\") {\n        this.setState({\n          visible: !this.state.visible\n        });\n      } else if (key === \"changeStatus\") {\n        this.setState({\n          visible: !this.state.visible,\n          flag: \"ChangeStatus\"\n        });\n      } else if (key === \"startVm\") {\n        this.setState({\n          flag: \"ChangeStatus\",\n          action: \"start\"\n        }, () => {\n          insListApi({\n            flag: this.state.flag,\n            action: this.state.action\n          }).then(res => {\n            console.log(\"startVm\", res);\n          }).catch(error => {\n            console.log(error);\n          });\n          message.success(\"Start VM successfully\");\n        });\n      } else {\n        this.setState({\n          flag: \"ChangeStatus\",\n          action: \"shutdown\"\n        }, () => {\n          insListApi({\n            flag: this.state.flag,\n            action: this.state.action\n          }).then(res => {\n            console.log(\"stopVm\", res);\n          }).catch(error => {\n            console.log(error);\n          });\n          message.success(\"Stop VM successfully\");\n        });\n      }\n\n      if (key) {\n        switch (key) {\n          case \"changeHostname\":\n            return this.setState({\n              menuKey: key,\n              title: \"Change Hostname\"\n            });\n\n          case \"migrateIns\":\n            return this.setState({\n              menuKey: key,\n              title: \"Migrate Instance\"\n            });\n\n          case \"resizeIns\":\n            return this.setState({\n              menuKey: key,\n              title: \"Resize Instance\"\n            });\n\n          case \"changeStatus\":\n            return this.setState({\n              title: \"Change Status\"\n            });\n\n          case \"startVm\":\n            return this.setState({\n              title: \"Start VM\"\n            });\n\n          case \"stopVm\":\n            return this.setState({\n              title: \"Stop VM\"\n            });\n\n          default:\n            return null;\n        }\n      }\n    };\n\n    this.handleChange = id => {\n      getInsInforById(id).then(res => {\n        console.log(\"handleChange-getInsInforById-res:\", res);\n        this.setState(sta => sta.everyData = res.instance);\n        console.log(\"handleChange-state.everyData\", this.state);\n      });\n    };\n\n    this.onCancel = () => {\n      console.log(\"cancel\");\n      this.setState({\n        visible: false,\n        key: Math.random()\n      });\n    };\n\n    this.handleOk = () => {\n      console.log(\"ok\");\n      this.setState({\n        visible: false,\n        key: Math.random()\n      });\n    };\n\n    this.loadData = (page, pageSize) => {\n      console.log(\"ins-loadData~~\", page, pageSize);\n\n      const _this = this;\n\n      const offset = (page - 1) * pageSize;\n      const limit = pageSize;\n      insListApi(offset, limit).then(res => {\n        console.log(\"loadData\", res);\n\n        _this.setState({\n          instances: res.instances,\n          isLoaded: true,\n          total: res.total,\n          pageSize: limit,\n          current: page\n        });\n\n        console.log(\"loadData-page-\", page, _this.state);\n      }).catch(error => {\n        _this.setState({\n          isLoaded: false,\n          error: error\n        });\n      });\n    };\n\n    this.toSelectchange = (page, num) => {\n      console.log(\"toSelectchange\", page, num);\n\n      const _this = this;\n\n      const offset = (page - 1) * num;\n      const limit = num;\n      console.log(\"instance-toSelectchange~limit:\", offset, limit);\n      insListApi(offset, limit).then(res => {\n        console.log(\"loadData\", res);\n\n        _this.setState({\n          instances: res.instances,\n          isLoaded: true,\n          total: res.total,\n          pageSize: limit,\n          current: page\n        });\n      }).catch(error => {\n        _this.setState({\n          isLoaded: false,\n          error: error\n        });\n      });\n    };\n\n    this.onPaginationChange = e => {\n      console.log(\"onPaginationChange\", e);\n      this.loadData(e, this.state.pageSize);\n    };\n\n    this.onShowSizeChange = (current, pageSize) => {\n      console.log(\"onShowSizeChange:\", current, pageSize); //当几条一页的值改变后调用函数，current：改变显示条数时当前数据所在页；pageSize:改变后的一页显示条数\n\n      this.toSelectchange(current, pageSize);\n    };\n\n    this.createInstance = () => {\n      this.props.history.push(\"/instances/new\");\n    };\n\n    this.onRef = (selectedRowKeys, selectedRows, selectedIds) => {\n      this.setState({\n        selectedRowKeys,\n        selectedRows,\n        selectedIds\n      });\n    };\n\n    this.onModalRef = ref => {\n      this.modalRef = ref;\n    };\n\n    this.modalFormList = data => {\n      console.log(\"instance-modalFormList\", data);\n      console.log(\"key-modalFormList\", this.state.menuKey);\n      const modalFormList = [{\n        type: \"INPUT\",\n        label: \"Hostname\",\n        name: \"hostname\",\n        field: \"Change Hostname\",\n        placeholder: \"Please input Hostname\",\n        width: \"90%\",\n        initialValue: data.Hostname,\n        id: data.ID\n      }, {\n        type: \"SELECT\",\n        width: \"200px\",\n        label: \"Hyper\",\n        name: \"hyper\",\n        field: \"Migrate Instance\",\n        // disabled:true,\n        initialValue: data.Hyper,\n        id: data.ID\n      }, {\n        type: \"SELECT\",\n        width: \"200px\",\n        label: \"Flavor\",\n        field: \"Resize Instance\",\n        name: \"flavor\",\n        initialValue: data.FlavorID,\n        id: data.ID\n      }, {\n        type: \"SELECT\",\n        label: \"Action\",\n        name: \"action\",\n        field: \"Change Status\",\n        placeholder: \"Please Select Status\",\n        width: \"90%\",\n        // disabled:true,\n        initialValue: data.Status,\n        id: data.ID\n      }];\n      return modalFormList;\n    };\n\n    this.handleSubmit = data => {\n      const id = this.state.everyData && this.state.everyData.ID;\n\n      if (id) {\n        const hostname = this.state.everyData && this.state.everyData.Hostname;\n        const hyper = this.state.everyData && this.state.everyData.Hyper;\n        const action = this.state.everyData && this.state.everyData.Status;\n        const flavor = this.state.everyData && this.state.everyData.FlavorID; // const ifaces = this.state.everyData.Interfaces[0].Address.SubnetID;\n\n        let ifaces = [];\n        this.state.everyData && this.state.everyData.Interfaces.map(item => {\n          ifaces.push(`${item.Address.SubnetID}`);\n          return ifaces;\n        });\n        let initInstance = {};\n        initInstance[\"hostname\"] = hostname;\n        initInstance[\"hyper\"] = hyper;\n        initInstance[\"action\"] = action;\n        initInstance[\"flavor\"] = flavor;\n        initInstance[\"ifaces\"] = ifaces;\n        this.setState({\n          updateInstance: initInstance\n        }, () => {\n          if (data.hostname) {\n            initInstance.hostname = data.hostname;\n          } else if (data.hyper) {\n            initInstance.hyper = data.hyper;\n          } else if (data.flavor) {\n            initInstance.flavor = data.flavor;\n          } else if (data.action) {\n            initInstance.action = data.action;\n          }\n\n          let dataInstance = Object.assign({}, this.state.updateInstance, initInstance, data);\n          console.log(\"dataInstance\", dataInstance);\n          this.handleUpdateList(id, dataInstance);\n        });\n      }\n    };\n\n    this.handleUpdateList = (id, paramsObj) => {\n      console.log(\"hangleUpdateList\", paramsObj, id);\n\n      if (id) {\n        editInsInfor(id, paramsObj).then(res => {\n          // let _json = res.data;\n          // if (_json.return_code === \"0\") {\n          console.log(\"handleUpdateList-editInsInfor:\", res); // } else {\n          //   message.error(res.message);\n          // }\n\n          this.loadData(this.state.current, this.state.pageSize);\n        }).catch(err => {\n          console.log(\"handleUpdateList-error:\", err);\n        });\n      }\n\n      this.modalRef.props.form.resetFields();\n      this.setState({\n        visible: false\n      });\n    };\n\n    this.state = {\n      updateInstance: {},\n      selectedRowKeys: [],\n      instances: [],\n      isLoaded: false,\n      total: 0,\n      pageSize: 10,\n      offset: 0,\n      pageSizeOptions: [\"5\", \"10\", \"15\", \"20\"],\n      current: 1,\n      visible: false,\n      everyData: {},\n      menuKey: \"\",\n      flag: \"\",\n      action: \"\"\n    };\n  }\n\n  componentWillMount() {\n    const _this = this;\n\n    insListApi().then(res => {\n      console.log(\"componentDidMount-instances:\", res);\n\n      _this.setState({\n        instances: res.instances,\n        isLoaded: true,\n        total: res.total\n      });\n    }).catch(error => {\n      _this.setState({\n        isLoaded: false,\n        error: error\n      });\n    });\n  }\n\n  render() {\n    const {\n      data,\n      everyData\n    } = this.state;\n    console.log(data, \"data\");\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(Row, {\n        children: /*#__PURE__*/_jsxDEV(Col, {\n          span: 24,\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            title: \"Instance Manage Panel\" + \"(Total: \" + this.state.total + \")\",\n            extra: /*#__PURE__*/_jsxDEV(Button, {\n              type: \"primary\",\n              size: \"small\",\n              onClick: this.createInstance,\n              children: \"Create\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 513,\n              columnNumber: 17\n            }, this),\n            children: /*#__PURE__*/_jsxDEV(Row, {\n              children: /*#__PURE__*/_jsxDEV(Col, {\n                span: 24,\n                children: [/*#__PURE__*/_jsxDEV(DataTable, {\n                  rowKey: \"ID\",\n                  columns: this.columns,\n                  dataSource: this.state.instances,\n                  bordered: true,\n                  total: this.state.total,\n                  pageSize: this.state.pageSize // scroll={{ y: 600, x: 600 }}\n                  ,\n                  onPaginationChange: this.onPaginationChange,\n                  onShowSizeChange: this.onShowSizeChange,\n                  pageSizeOptions: this.state.pageSizeOptions,\n                  loading: !this.state.isLoaded\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 524,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(InstModal, {\n                  onRef: this.onModalRef,\n                  visible: this.state.visible,\n                  modalFormList: this.modalFormList(everyData),\n                  title: this.state.title,\n                  submit: this.handleSubmit.bind(this),\n                  close: () => {\n                    this.setState({\n                      visible: false,\n                      everyData: {}\n                    });\n                    this.modalRef.props.form.resetFields();\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 537,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 523,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 522,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 508,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 507,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 506,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 505,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default Instances;","map":{"version":3,"sources":["/Users/emily/cloudland/src/pages/instances/Instances.jsx"],"names":["React","Component","Card","Table","Button","Popconfirm","Pagination","Row","Col","Menu","Dropdown","message","Modal","insListApi","delInsInfor","getInsInforById","editInsInfor","DataTable","InstModal","Instances","constructor","props","columns","title","key","width","align","dataIndex","Math","random","render","Interfaces","map","iface","Address","console","log","state","instances","txt","record","index","history","push","ID","menu","then","res","success","Msg","loadData","current","pageSize","margin","marginRight","marginTop","height","r","handleModal","bind","id","handleChange","setState","visible","flag","action","catch","error","menuKey","sta","everyData","instance","onCancel","handleOk","page","_this","offset","limit","isLoaded","total","toSelectchange","num","onPaginationChange","e","onShowSizeChange","createInstance","onRef","selectedRowKeys","selectedRows","selectedIds","onModalRef","ref","modalRef","modalFormList","data","type","label","name","field","placeholder","initialValue","Hostname","Hyper","FlavorID","Status","handleSubmit","hostname","hyper","flavor","ifaces","item","SubnetID","initInstance","updateInstance","dataInstance","Object","assign","handleUpdateList","paramsObj","err","form","resetFields","pageSizeOptions","componentWillMount"],"mappings":"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","sourcesContent":["/*\n\nCopyright <holder> All Rights Reserved\n\nSPDX-License-Identifier: Apache-2.0\n\n*/\nimport React, { Component } from \"react\";\nimport {\n  Card,\n  Table,\n  Button,\n  Popconfirm,\n  Pagination,\n  Row,\n  Col,\n  Menu,\n  Dropdown,\n  message,\n  Modal,\n} from \"antd\";\nimport {\n  insListApi,\n  delInsInfor,\n  getInsInforById,\n  editInsInfor,\n} from \"../../service/instances\";\nimport DataTable from \"../../components/DataTable/DataTable\";\n\nimport InstModal from \"./InstModal\";\nimport \"./instances.css\";\n\nclass Instances extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      updateInstance: {},\n      selectedRowKeys: [],\n      instances: [],\n      isLoaded: false,\n      total: 0,\n      pageSize: 10,\n      offset: 0,\n      pageSizeOptions: [\"5\", \"10\", \"15\", \"20\"],\n      current: 1,\n      visible: false,\n      everyData: {},\n      menuKey: \"\",\n      flag: \"\",\n      action: \"\",\n    };\n  }\n\n  columns = [\n    {\n      title: \"ID\",\n      key: \"ID\",\n      width: 60,\n      align: \"center\",\n      dataIndex: \"ID\",\n    },\n    {\n      title: \"HostName\",\n      dataIndex: \"Hostname\",\n      align: \"center\",\n    },\n    {\n      title: \"Flavor\",\n      dataIndex: \"Flavor.Name\",\n      align: \"center\",\n    },\n    {\n      title: \"Image\",\n      dataIndex: \"Image.Name\",\n      align: \"center\",\n    },\n    {\n      title: \"IP Address\",\n      dataIndex: \"Interfaces\",\n      key: Math.random(),\n      align: \"center\",\n      render: (Interfaces) => (\n        <span>\n          {Interfaces.map((iface) => {\n            return iface.Address.Address + \" \";\n          })}\n        </span>\n      ),\n    },\n    {\n      title: \"Console\",\n      dataIndex: \"\",\n      align: \"center\",\n    },\n    {\n      title: \"Status\",\n      dataIndex: \"Status\",\n      align: \"center\",\n    },\n    {\n      title: \"Hyper\",\n      dataIndex: \"Hyper\",\n      align: \"center\",\n    },\n    {\n      title: \"Owner\",\n      dataIndex: \"Interfaces\",\n      align: \"center\",\n      render: console.log(\"interface:\", this.state.instances),\n      // render: (Interfaces) => (\n      //   <span>\n      //     {Interfaces.map((iface) => {\n      //       return iface.Secgroups[0].Name;\n      //     })}\n      //   </span>\n      // ),\n    },\n    {\n      title: \"Zone\",\n      dataIndex: \"Zone.Name\",\n      align: \"center\",\n    },\n    {\n      title: \"Action\",\n      align: \"center\",\n      render: (txt, record, index) => {\n        return (\n          <div className=\"actionStyle\">\n            <Dropdown.Button\n              type=\"primary\"\n              onClick={() => {\n                console.log(\"onClick:\", record);\n                this.props.history.push(\"/instances/new/\" + record.ID);\n              }}\n              overlay={this.menu(record.ID)}\n            >\n              Edit\n            </Dropdown.Button>\n            <Popconfirm\n              title=\"Are you sure to delete?\"\n              onCancel={() => {\n                console.log(\"cancelled\");\n              }}\n              onConfirm={() => {\n                console.log(\"onClick-delete:\", record);\n                delInsInfor(record.ID).then((res) => {\n                  message.success(res.Msg);\n                  this.loadData(this.state.current, this.state.pageSize);\n\n                  console.log(\"用户~~\", res);\n                  console.log(\"用户~~state\", this.state);\n                });\n              }}\n            >\n              <Button\n                style={{\n                  margin: \"5px\",\n                  marginRight: \"0px\",\n                  marginTop: \"10px\",\n                  height: \"32px\",\n                }}\n                type=\"danger\"\n                size=\"small\"\n              >\n                Delete\n              </Button>\n            </Popconfirm>\n          </div>\n        );\n      },\n    },\n  ];\n  menu = (r) => (\n    <Menu onClick={this.handleModal.bind(this, r)}>\n      <Menu.Item key=\"changeHostname\">Change Hostname</Menu.Item>\n      <Menu.Item key=\"migrateIns\">Migrate Instance</Menu.Item>\n      <Menu.Item key=\"resizeIns\">Resize Instance</Menu.Item>\n      <Menu.Item key=\"changeStatus\">Change Status</Menu.Item>\n      <Menu.Item key=\"startVm\">Start VM</Menu.Item>\n      <Menu.Item key=\"stopVm\">Stop VM</Menu.Item>\n    </Menu>\n  );\n\n  handleModal = (id, { key }) => {\n    console.log(\"handleModal-key\", key);\n    this.handleChange(id);\n    console.log(\"handleModal\", id);\n    if (\n      key === \"changeHostname\" ||\n      key === \"migrateIns\" ||\n      key === \"resizeIns\"\n    ) {\n      this.setState({\n        visible: !this.state.visible,\n      });\n    } else if (key === \"changeStatus\") {\n      this.setState({\n        visible: !this.state.visible,\n        flag: \"ChangeStatus\",\n      });\n    } else if (key === \"startVm\") {\n      this.setState(\n        {\n          flag: \"ChangeStatus\",\n          action: \"start\",\n        },\n        () => {\n          insListApi({ flag: this.state.flag, action: this.state.action })\n            .then((res) => {\n              console.log(\"startVm\", res);\n            })\n            .catch((error) => {\n              console.log(error);\n            });\n          message.success(\"Start VM successfully\");\n        }\n      );\n    } else {\n      this.setState(\n        {\n          flag: \"ChangeStatus\",\n          action: \"shutdown\",\n        },\n        () => {\n          insListApi({ flag: this.state.flag, action: this.state.action })\n            .then((res) => {\n              console.log(\"stopVm\", res);\n            })\n            .catch((error) => {\n              console.log(error);\n            });\n          message.success(\"Stop VM successfully\");\n        }\n      );\n    }\n\n    if (key) {\n      switch (key) {\n        case \"changeHostname\":\n          return this.setState({\n            menuKey: key,\n            title: \"Change Hostname\",\n          });\n        case \"migrateIns\":\n          return this.setState({\n            menuKey: key,\n            title: \"Migrate Instance\",\n          });\n        case \"resizeIns\":\n          return this.setState({\n            menuKey: key,\n            title: \"Resize Instance\",\n          });\n        case \"changeStatus\":\n          return this.setState({\n            title: \"Change Status\",\n          });\n        case \"startVm\":\n          return this.setState({\n            title: \"Start VM\",\n          });\n        case \"stopVm\":\n          return this.setState({\n            title: \"Stop VM\",\n          });\n        default:\n          return null;\n      }\n    }\n  };\n\n  handleChange = (id) => {\n    getInsInforById(id).then((res) => {\n      console.log(\"handleChange-getInsInforById-res:\", res);\n      this.setState((sta) => (sta.everyData = res.instance));\n      console.log(\"handleChange-state.everyData\", this.state);\n    });\n  };\n  onCancel = () => {\n    console.log(\"cancel\");\n    this.setState({\n      visible: false,\n      key: Math.random(),\n    });\n  };\n  handleOk = () => {\n    console.log(\"ok\");\n    this.setState({\n      visible: false,\n      key: Math.random(),\n    });\n  };\n  componentWillMount() {\n    const _this = this;\n    insListApi()\n      .then((res) => {\n        console.log(\"componentDidMount-instances:\", res);\n        _this.setState({\n          instances: res.instances,\n          isLoaded: true,\n          total: res.total,\n        });\n      })\n      .catch((error) => {\n        _this.setState({\n          isLoaded: false,\n          error: error,\n        });\n      });\n  }\n  loadData = (page, pageSize) => {\n    console.log(\"ins-loadData~~\", page, pageSize);\n    const _this = this;\n    const offset = (page - 1) * pageSize;\n    const limit = pageSize;\n    insListApi(offset, limit)\n      .then((res) => {\n        console.log(\"loadData\", res);\n        _this.setState({\n          instances: res.instances,\n          isLoaded: true,\n          total: res.total,\n          pageSize: limit,\n          current: page,\n        });\n        console.log(\"loadData-page-\", page, _this.state);\n      })\n      .catch((error) => {\n        _this.setState({\n          isLoaded: false,\n          error: error,\n        });\n      });\n  };\n  toSelectchange = (page, num) => {\n    console.log(\"toSelectchange\", page, num);\n    const _this = this;\n    const offset = (page - 1) * num;\n    const limit = num;\n    console.log(\"instance-toSelectchange~limit:\", offset, limit);\n    insListApi(offset, limit)\n      .then((res) => {\n        console.log(\"loadData\", res);\n        _this.setState({\n          instances: res.instances,\n          isLoaded: true,\n          total: res.total,\n          pageSize: limit,\n          current: page,\n        });\n      })\n      .catch((error) => {\n        _this.setState({\n          isLoaded: false,\n          error: error,\n        });\n      });\n  };\n  onPaginationChange = (e) => {\n    console.log(\"onPaginationChange\", e);\n    this.loadData(e, this.state.pageSize);\n  };\n  onShowSizeChange = (current, pageSize) => {\n    console.log(\"onShowSizeChange:\", current, pageSize);\n    //当几条一页的值改变后调用函数，current：改变显示条数时当前数据所在页；pageSize:改变后的一页显示条数\n    this.toSelectchange(current, pageSize);\n  };\n\n  createInstance = () => {\n    this.props.history.push(\"/instances/new\");\n  };\n  onRef = (selectedRowKeys, selectedRows, selectedIds) => {\n    this.setState({\n      selectedRowKeys,\n      selectedRows,\n      selectedIds,\n    });\n  };\n  onModalRef = (ref) => {\n    this.modalRef = ref;\n  };\n  modalFormList = (data) => {\n    console.log(\"instance-modalFormList\", data);\n    console.log(\"key-modalFormList\", this.state.menuKey);\n    const modalFormList = [\n      {\n        type: \"INPUT\",\n        label: \"Hostname\",\n        name: \"hostname\",\n        field: \"Change Hostname\",\n        placeholder: \"Please input Hostname\",\n        width: \"90%\",\n        initialValue: data.Hostname,\n        id: data.ID,\n      },\n      {\n        type: \"SELECT\",\n        width: \"200px\",\n        label: \"Hyper\",\n        name: \"hyper\",\n        field: \"Migrate Instance\",\n        // disabled:true,\n        initialValue: data.Hyper,\n        id: data.ID,\n      },\n      {\n        type: \"SELECT\",\n        width: \"200px\",\n        label: \"Flavor\",\n        field: \"Resize Instance\",\n        name: \"flavor\",\n        initialValue: data.FlavorID,\n        id: data.ID,\n      },\n      {\n        type: \"SELECT\",\n        label: \"Action\",\n        name: \"action\",\n        field: \"Change Status\",\n        placeholder: \"Please Select Status\",\n        width: \"90%\",\n        // disabled:true,\n        initialValue: data.Status,\n        id: data.ID,\n      },\n    ];\n    return modalFormList;\n  };\n  handleSubmit = (data) => {\n    const id = this.state.everyData && this.state.everyData.ID;\n    if (id) {\n      const hostname = this.state.everyData && this.state.everyData.Hostname;\n      const hyper = this.state.everyData && this.state.everyData.Hyper;\n      const action = this.state.everyData && this.state.everyData.Status;\n      const flavor = this.state.everyData && this.state.everyData.FlavorID;\n      // const ifaces = this.state.everyData.Interfaces[0].Address.SubnetID;\n      let ifaces = [];\n\n      this.state.everyData &&\n        this.state.everyData.Interfaces.map((item) => {\n          ifaces.push(`${item.Address.SubnetID}`);\n          return ifaces;\n        });\n\n      let initInstance = {};\n      initInstance[\"hostname\"] = hostname;\n      initInstance[\"hyper\"] = hyper;\n      initInstance[\"action\"] = action;\n      initInstance[\"flavor\"] = flavor;\n      initInstance[\"ifaces\"] = ifaces;\n      this.setState(\n        {\n          updateInstance: initInstance,\n        },\n        () => {\n          if (data.hostname) {\n            initInstance.hostname = data.hostname;\n          } else if (data.hyper) {\n            initInstance.hyper = data.hyper;\n          } else if (data.flavor) {\n            initInstance.flavor = data.flavor;\n          } else if (data.action) {\n            initInstance.action = data.action;\n          }\n          let dataInstance = Object.assign(\n            {},\n            this.state.updateInstance,\n            initInstance,\n            data\n          );\n          console.log(\"dataInstance\", dataInstance);\n          this.handleUpdateList(id, dataInstance);\n        }\n      );\n    }\n  };\n  handleUpdateList = (id, paramsObj) => {\n    console.log(\"hangleUpdateList\", paramsObj, id);\n    if (id) {\n      editInsInfor(id, paramsObj)\n        .then((res) => {\n          // let _json = res.data;\n          // if (_json.return_code === \"0\") {\n          console.log(\"handleUpdateList-editInsInfor:\", res);\n          // } else {\n          //   message.error(res.message);\n          // }\n          this.loadData(this.state.current, this.state.pageSize);\n        })\n        .catch((err) => {\n          console.log(\"handleUpdateList-error:\", err);\n        });\n    }\n\n    this.modalRef.props.form.resetFields();\n    this.setState({\n      visible: false,\n    });\n  };\n\n  render() {\n    const { data, everyData } = this.state;\n    console.log(data, \"data\");\n    return (\n      <div>\n        <Row>\n          <Col span={24}>\n            <Card\n              title={\n                \"Instance Manage Panel\" + \"(Total: \" + this.state.total + \")\"\n              }\n              extra={\n                <Button\n                  type=\"primary\"\n                  size=\"small\"\n                  onClick={this.createInstance}\n                >\n                  Create\n                </Button>\n              }\n            >\n              <Row>\n                <Col span={24}>\n                  <DataTable\n                    rowKey=\"ID\"\n                    columns={this.columns}\n                    dataSource={this.state.instances}\n                    bordered\n                    total={this.state.total}\n                    pageSize={this.state.pageSize}\n                    // scroll={{ y: 600, x: 600 }}\n                    onPaginationChange={this.onPaginationChange}\n                    onShowSizeChange={this.onShowSizeChange}\n                    pageSizeOptions={this.state.pageSizeOptions}\n                    loading={!this.state.isLoaded}\n                  />\n                  <InstModal\n                    onRef={this.onModalRef}\n                    visible={this.state.visible}\n                    modalFormList={this.modalFormList(everyData)}\n                    title={this.state.title}\n                    submit={this.handleSubmit.bind(this)}\n                    close={() => {\n                      this.setState({\n                        visible: false,\n                        everyData: {},\n                      });\n                      this.modalRef.props.form.resetFields();\n                    }}\n                  />\n                </Col>\n              </Row>\n            </Card>\n          </Col>\n        </Row>\n      </div>\n    );\n  }\n}\nexport default Instances;\n"]},"metadata":{},"sourceType":"module"}