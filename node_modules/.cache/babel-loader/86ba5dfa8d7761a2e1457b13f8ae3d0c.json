{"ast":null,"code":"import _objectSpread from\"/Users/emily/cloudland/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/emily/cloudland/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/emily/cloudland/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/emily/cloudland/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/emily/cloudland/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/*\n\nCopyright <holder> All Rights Reserved\n\nSPDX-License-Identifier: Apache-2.0\n\n*/import React,{Component}from\"react\";import{Form,Card,Input,Select,Button,message}from\"antd\";import{createRegApi,getRegInforById,editRegInfor}from\"../../service/registrys\";import\"./registrys.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var layoutButton={labelCol:{span:8},wrapperCol:{span:16}};var layoutForm={labelCol:{span:6},wrapperCol:{span:10}};var ModifyRegistrys=/*#__PURE__*/function(_Component){_inherits(ModifyRegistrys,_Component);var _super=_createSuper(ModifyRegistrys);function ModifyRegistrys(props){var _this;_classCallCheck(this,ModifyRegistrys);_this=_super.call(this,props);//const { getFieldDecorator } = this.props.form;\n_this.listRegistrys=function(){_this.props.history.push(\"/registrys\");};_this.handleSubmit=function(e){console.log(\"handleSubmit:\",e);e.preventDefault();_this.props.form.validateFieldsAndScroll(function(err,values){if(!err){console.log(\"handleSubmit-value:\",values);console.log(\"提交\");if(_this.props.match.params.id){//const _this = this;\neditRegInfor(_this.props.match.params.id,values).then(function(res){console.log(\"editRegInfor:\",res);// _this.setState({\n//   isShowEdit: ! this.state.isShowEdit,\n// });\n_this.props.history.push(\"/registrys\");});}else{createRegApi(values).then(function(res){console.log(\"handleSubmit-res-createRegApi:\",res);_this.props.history.push(\"/registrys\");}).catch(function(err){console.log(\"handleSubmit-error:\",err);});}}else{message.error(\" input wrong information\");}});};_this.regContentValidate=function(rule,value,callback){console.log(\"regContentValidate:\",value);if(value.indexOf(\"pullSecret\")===-1){callback(\"Registry Content should be started with 'pullSecret'\");//调用api 接口\n}else{callback();}};console.log(\"ModifyRegistry~~\",props);_this.state={isShowEdit:false,currentData:[]};if(props.match.params.id){getRegInforById(props.match.params.id).then(function(res){console.log(\"getRegInforById:\",res);_this.setState({currentData:res,isShowEdit:true});});}return _this;}_createClass(ModifyRegistrys,[{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsx(Card,{title:this.state.isShowEdit?\"Edit Registry\":\"Create Registry\",extra:/*#__PURE__*/_jsx(Button,{type:\"primary\",onClick:this.listRegistrys,children:\"Return\"}),children:/*#__PURE__*/_jsxs(Form,{layout:\"horizontal\",wrapperCol:_objectSpread({},layoutForm.wrapperCol),onSubmit:function onSubmit(e){return _this2.handleSubmit(e);},children:[/*#__PURE__*/_jsx(Form.Item,{label:\"Label\",name:\"label\",labelCol:_objectSpread({},layoutForm.labelCol),children:this.props.form.getFieldDecorator(\"label\",{rules:[{required:true}],initialValue:this.state.currentData.Label})(/*#__PURE__*/_jsx(Input,{}))}),/*#__PURE__*/_jsx(Form.Item,{label:\"Virtualization Type\",name:\"virttype\",labelCol:_objectSpread({},layoutForm.labelCol),children:this.props.form.getFieldDecorator(\"virttype\",{rules:[{required:true}],initialValue:this.state.currentData.VirtType})(/*#__PURE__*/_jsxs(Select,{disabled:this.state.isShowEdit,children:[/*#__PURE__*/_jsx(Select.Option,{value:\"kvm on x86_64\",children:\"KVM on x86_64\"}),/*#__PURE__*/_jsx(Select.Option,{value:\"kvm on z\",children:\"KVM on Z\"}),/*#__PURE__*/_jsx(Select.Option,{value:\"zvm\",children:\"Z/VM\"})]}))}),/*#__PURE__*/_jsx(Form.Item,{label:\"Ocp Version\",name:\"ocpversion\",labelCol:_objectSpread({},layoutForm.labelCol),children:this.props.form.getFieldDecorator(\"ocpversion\",{rules:[{required:true}],initialValue:this.state.currentData.OcpVersion})(/*#__PURE__*/_jsxs(Select,{disabled:this.state.isShowEdit,children:[/*#__PURE__*/_jsx(Select.Option,{value:\"4.3\",children:\"4.3\"}),/*#__PURE__*/_jsx(Select.Option,{value:\"4.4\",children:\"4.4\"}),/*#__PURE__*/_jsx(Select.Option,{value:\"4.5\",children:\"4.5\"}),/*#__PURE__*/_jsx(Select.Option,{value:\"4.6\",children:\"4.6\"}),/*#__PURE__*/_jsx(Select.Option,{value:\"4.7\",children:\"4.7\"})]}))}),/*#__PURE__*/_jsx(Form.Item,{name:\"registrycontent\",label:\"Registry Content\",labelCol:_objectSpread({},layoutForm.labelCol),children:this.props.form.getFieldDecorator(\"registrycontent\",{rules:[{required:true},{validator:this.regContentValidate}],initialValue:this.state.currentData.RegistryContent})(/*#__PURE__*/_jsx(Input.TextArea,{showCount:\"true\",autoSize:{minRows:3,maxRows:6},placeholder:\"pullSecret: ...\\nadditionalTrustBundle: | -----BEGIN CERTIFICATE----- ... -----END CERTIFICATE----- \\nimageContentSources: ...\"}))}),/*#__PURE__*/_jsx(Form.Item,{name:\"initramfs\",label:\"RHCOS initramfs\",labelCol:_objectSpread({},layoutForm.labelCol),children:this.props.form.getFieldDecorator(\"initramfs\",{rules:[{required:true}],initialValue:this.state.currentData.Initramfs})(/*#__PURE__*/_jsx(Input,{}))}),/*#__PURE__*/_jsx(Form.Item,{name:\"kernel\",label:\"RHCOS kernel\",labelCol:_objectSpread({},layoutForm.labelCol),children:this.props.form.getFieldDecorator(\"kernel\",{rules:[{required:true}],initialValue:this.state.currentData.Kernel})(/*#__PURE__*/_jsx(Input,{}))}),/*#__PURE__*/_jsx(Form.Item,{name:\"image\",label:\"RHCOS image\",labelCol:_objectSpread({},layoutForm.labelCol),children:this.props.form.getFieldDecorator(\"image\",{rules:[{required:true}],initialValue:this.state.currentData.Image})(/*#__PURE__*/_jsx(Input,{}))}),/*#__PURE__*/_jsx(Form.Item,{name:\"installer\",label:\"OCP installer\",labelCol:_objectSpread({},layoutForm.labelCol),children:this.props.form.getFieldDecorator(\"installer\",{rules:[{required:true}],initialValue:this.state.currentData.Installer})(/*#__PURE__*/_jsx(Input,{}))}),/*#__PURE__*/_jsx(Form.Item,{name:\"cli\",label:\"OCP client\",labelCol:_objectSpread({},layoutForm.labelCol),children:this.props.form.getFieldDecorator(\"cli\",{rules:[{required:true}],initialValue:this.state.currentData.Cli})(/*#__PURE__*/_jsx(Input,{}))}),/*#__PURE__*/_jsx(Form.Item,{wrapperCol:_objectSpread(_objectSpread({},layoutButton.wrapperCol),{},{offset:8}),labelCol:{span:6},children:this.state.isShowEdit?/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",children:\"Update Registry\"}):/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",children:\"Create Registry\"})})]})});}}]);return ModifyRegistrys;}(Component);export default Form.create({name:\"modifyRegistrys\"})(ModifyRegistrys);","map":{"version":3,"sources":["/Users/emily/cloudland/src/pages/registrys/ModifyRegistrys.jsx"],"names":["React","Component","Form","Card","Input","Select","Button","message","createRegApi","getRegInforById","editRegInfor","layoutButton","labelCol","span","wrapperCol","layoutForm","ModifyRegistrys","props","listRegistrys","history","push","handleSubmit","e","console","log","preventDefault","form","validateFieldsAndScroll","err","values","match","params","id","then","res","catch","error","regContentValidate","rule","value","callback","indexOf","state","isShowEdit","currentData","setState","getFieldDecorator","rules","required","initialValue","Label","VirtType","OcpVersion","validator","RegistryContent","minRows","maxRows","Initramfs","Kernel","Image","Installer","Cli","offset","create","name"],"mappings":"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","sourcesContent":["/*\n\nCopyright <holder> All Rights Reserved\n\nSPDX-License-Identifier: Apache-2.0\n\n*/\nimport React, { Component } from \"react\";\nimport { Form, Card, Input, Select, Button, message } from \"antd\";\nimport {\n  createRegApi,\n  getRegInforById,\n  editRegInfor,\n} from \"../../service/registrys\";\nimport \"./registrys.css\";\nconst layoutButton = {\n  labelCol: { span: 8 },\n  wrapperCol: { span: 16 },\n};\nconst layoutForm = {\n  labelCol: { span: 6 },\n  wrapperCol: { span: 10 },\n};\nclass ModifyRegistrys extends Component {\n  constructor(props) {\n    super(props);\n    //const { getFieldDecorator } = this.props.form;\n    console.log(\"ModifyRegistry~~\", props);\n    this.state = {\n      isShowEdit: false,\n      currentData: [],\n    };\n    if (props.match.params.id) {\n      getRegInforById(props.match.params.id).then((res) => {\n        console.log(\"getRegInforById:\", res);\n        this.setState({\n          currentData: res,\n          isShowEdit: true,\n        });\n      });\n    }\n  }\n\n  listRegistrys = () => {\n    this.props.history.push(\"/registrys\");\n  };\n  handleSubmit = (e) => {\n    console.log(\"handleSubmit:\", e);\n    e.preventDefault();\n    this.props.form.validateFieldsAndScroll((err, values) => {\n      if (!err) {\n        console.log(\"handleSubmit-value:\", values);\n        console.log(\"提交\");\n        if (this.props.match.params.id) {\n          //const _this = this;\n          editRegInfor(this.props.match.params.id, values).then((res) => {\n            console.log(\"editRegInfor:\", res);\n            // _this.setState({\n            //   isShowEdit: ! this.state.isShowEdit,\n            // });\n            this.props.history.push(\"/registrys\");\n          });\n        } else {\n          createRegApi(values)\n            .then((res) => {\n              console.log(\"handleSubmit-res-createRegApi:\", res);\n              this.props.history.push(\"/registrys\");\n            })\n            .catch((err) => {\n              console.log(\"handleSubmit-error:\", err);\n            });\n        }\n      } else {\n        message.error(\" input wrong information\");\n      }\n    });\n  };\n  //check if Registry content starts with \"pullSecret\"\n  regContentValidate = (rule, value, callback) => {\n    console.log(\"regContentValidate:\", value);\n    if (value.indexOf(\"pullSecret\") === -1) {\n      callback(\"Registry Content should be started with 'pullSecret'\");\n\n      //调用api 接口\n    } else {\n      callback();\n    }\n  };\n  render() {\n    return (\n      <Card\n        title={this.state.isShowEdit ? \"Edit Registry\" : \"Create Registry\"}\n        extra={\n          <Button type=\"primary\" onClick={this.listRegistrys}>\n            Return\n          </Button>\n        }\n      >\n        <Form\n          layout=\"horizontal\"\n          wrapperCol={{ ...layoutForm.wrapperCol }}\n          onSubmit={(e) => this.handleSubmit(e)}\n        >\n          <Form.Item\n            label=\"Label\"\n            name=\"label\"\n            labelCol={{ ...layoutForm.labelCol }}\n          >\n            {this.props.form.getFieldDecorator(\"label\", {\n              rules: [\n                {\n                  required: true,\n                },\n              ],\n              initialValue: this.state.currentData.Label,\n            })(<Input />)}\n          </Form.Item>\n          <Form.Item\n            label=\"Virtualization Type\"\n            name=\"virttype\"\n            labelCol={{ ...layoutForm.labelCol }}\n          >\n            {this.props.form.getFieldDecorator(\"virttype\", {\n              rules: [\n                {\n                  required: true,\n                },\n              ],\n              initialValue: this.state.currentData.VirtType,\n            })(\n              <Select disabled={this.state.isShowEdit}>\n                <Select.Option value=\"kvm on x86_64\">\n                  KVM on x86_64\n                </Select.Option>\n                <Select.Option value=\"kvm on z\">KVM on Z</Select.Option>\n                <Select.Option value=\"zvm\">Z/VM</Select.Option>\n              </Select>\n            )}\n          </Form.Item>\n          <Form.Item\n            label=\"Ocp Version\"\n            name=\"ocpversion\"\n            labelCol={{ ...layoutForm.labelCol }}\n          >\n            {this.props.form.getFieldDecorator(\"ocpversion\", {\n              rules: [\n                {\n                  required: true,\n                },\n              ],\n              initialValue: this.state.currentData.OcpVersion,\n            })(\n              <Select disabled={this.state.isShowEdit}>\n                <Select.Option value=\"4.3\">4.3</Select.Option>\n                <Select.Option value=\"4.4\">4.4</Select.Option>\n                <Select.Option value=\"4.5\">4.5</Select.Option>\n                <Select.Option value=\"4.6\">4.6</Select.Option>\n                <Select.Option value=\"4.7\">4.7</Select.Option>\n              </Select>\n            )}\n          </Form.Item>\n          <Form.Item\n            name=\"registrycontent\"\n            label=\"Registry Content\"\n            labelCol={{ ...layoutForm.labelCol }}\n          >\n            {this.props.form.getFieldDecorator(\"registrycontent\", {\n              rules: [\n                {\n                  required: true,\n                },\n                {\n                  validator: this.regContentValidate,\n                },\n              ],\n              initialValue: this.state.currentData.RegistryContent,\n            })(\n              <Input.TextArea\n                showCount=\"true\"\n                autoSize={{ minRows: 3, maxRows: 6 }}\n                placeholder=\"pullSecret: ...&#10;additionalTrustBundle: | -----BEGIN CERTIFICATE----- ... -----END CERTIFICATE----- &#10;imageContentSources: ...\"\n              />\n            )}\n          </Form.Item>\n          <Form.Item\n            name=\"initramfs\"\n            label=\"RHCOS initramfs\"\n            labelCol={{ ...layoutForm.labelCol }}\n          >\n            {this.props.form.getFieldDecorator(\"initramfs\", {\n              rules: [\n                {\n                  required: true,\n                },\n              ],\n              initialValue: this.state.currentData.Initramfs,\n            })(<Input />)}\n          </Form.Item>\n          <Form.Item\n            name=\"kernel\"\n            label=\"RHCOS kernel\"\n            labelCol={{ ...layoutForm.labelCol }}\n          >\n            {this.props.form.getFieldDecorator(\"kernel\", {\n              rules: [\n                {\n                  required: true,\n                },\n              ],\n              initialValue: this.state.currentData.Kernel,\n            })(<Input />)}\n          </Form.Item>\n          <Form.Item\n            name=\"image\"\n            label=\"RHCOS image\"\n            labelCol={{ ...layoutForm.labelCol }}\n          >\n            {this.props.form.getFieldDecorator(\"image\", {\n              rules: [\n                {\n                  required: true,\n                },\n              ],\n              initialValue: this.state.currentData.Image,\n            })(<Input />)}\n          </Form.Item>\n          <Form.Item\n            name=\"installer\"\n            label=\"OCP installer\"\n            labelCol={{ ...layoutForm.labelCol }}\n          >\n            {this.props.form.getFieldDecorator(\"installer\", {\n              rules: [\n                {\n                  required: true,\n                },\n              ],\n              initialValue: this.state.currentData.Installer,\n            })(<Input />)}\n          </Form.Item>\n          <Form.Item\n            name=\"cli\"\n            label=\"OCP client\"\n            labelCol={{ ...layoutForm.labelCol }}\n          >\n            {this.props.form.getFieldDecorator(\"cli\", {\n              rules: [\n                {\n                  required: true,\n                },\n              ],\n              initialValue: this.state.currentData.Cli,\n            })(<Input />)}\n          </Form.Item>\n          <Form.Item\n            wrapperCol={{ ...layoutButton.wrapperCol, offset: 8 }}\n            labelCol={{ span: 6 }}\n          >\n            {this.state.isShowEdit ? (\n              <Button type=\"primary\" htmlType=\"submit\">\n                Update Registry\n              </Button>\n            ) : (\n              <Button type=\"primary\" htmlType=\"submit\">\n                Create Registry\n              </Button>\n            )}\n          </Form.Item>\n        </Form>\n      </Card>\n    );\n  }\n}\nexport default Form.create({ name: \"modifyRegistrys\" })(ModifyRegistrys);\n"]},"metadata":{},"sourceType":"module"}