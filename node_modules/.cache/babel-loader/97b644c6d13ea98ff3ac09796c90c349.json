{"ast":null,"code":"/*\n\nCopyright <holder> All Rights Reserved\n\nSPDX-License-Identifier: Apache-2.0\n\n*/import{message}from\"antd\";import axios from\"axios\";import{getToken}from\"./auth\";var instance=axios.create({baseURL:\"https://cloudland.pic.cdl.ibm.com\",timeout:5000,headers:{\"Content-Type\":\"application/json;charset=UTF-8\",\"Allow-Control-Allow-Origin\":\"*\"}});//全局请求拦截，发送请求之前执行\ninstance.interceptors.request.use(function(config){console.log(\"getToken():\",getToken());if(getToken()){config.headers.common[\"X-Auth-Token\"]=getToken();}else{delete config.headers.common[\"x-auth-token\"];// router.push({\n//   name: \"login\",\n// });\n}return config;},function(error){return Promise.reject(error);});//请求返回之后执行\ninstance.interceptors.response.use(function(response){console.log(\"axios-response\",response);return response.data;},function(error){if(error.response){switch(error.response.status){case 401:console.log(\"Need Login\");window.location=\"/login\";break;default:message.error(error.response.data.ErrorMsg,5);break;}}console.log(\"axios-error\",error.response);return Promise.reject(error.response.data);// console.log(\"axios-error\", error.response);\n// return Promise.reject(error);\n});export default instance;","map":{"version":3,"sources":["/Users/emily/cloudland/src/utils/request.jsx"],"names":["message","axios","getToken","instance","create","baseURL","timeout","headers","interceptors","request","use","config","console","log","common","error","Promise","reject","response","data","status","window","location","ErrorMsg"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA,EACA,OAASA,OAAT,KAAwB,MAAxB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,QAAT,KAAyB,QAAzB,CAEA,GAAMC,CAAAA,QAAQ,CAAGF,KAAK,CAACG,MAAN,CAAa,CAC5BC,OAAO,CAAE,mCADmB,CAE5BC,OAAO,CAAE,IAFmB,CAG5BC,OAAO,CAAE,CACP,eAAgB,gCADT,CAEP,6BAA8B,GAFvB,CAHmB,CAAb,CAAjB,CAQA;AACAJ,QAAQ,CAACK,YAAT,CAAsBC,OAAtB,CAA8BC,GAA9B,CACE,SAACC,MAAD,CAAY,CACVC,OAAO,CAACC,GAAR,CAAY,aAAZ,CAA2BX,QAAQ,EAAnC,EACA,GAAIA,QAAQ,EAAZ,CAAgB,CACdS,MAAM,CAACJ,OAAP,CAAeO,MAAf,CAAsB,cAAtB,EAAwCZ,QAAQ,EAAhD,CACD,CAFD,IAEO,CACL,MAAOS,CAAAA,MAAM,CAACJ,OAAP,CAAeO,MAAf,CAAsB,cAAtB,CAAP,CACA;AACA;AACA;AACD,CAED,MAAOH,CAAAA,MAAP,CACD,CAbH,CAcE,SAACI,KAAD,CAAW,CACT,MAAOC,CAAAA,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP,CACD,CAhBH,EAkBA;AACAZ,QAAQ,CAACK,YAAT,CAAsBU,QAAtB,CAA+BR,GAA/B,CACE,SAACQ,QAAD,CAAc,CACZN,OAAO,CAACC,GAAR,CAAY,gBAAZ,CAA8BK,QAA9B,EACA,MAAOA,CAAAA,QAAQ,CAACC,IAAhB,CACD,CAJH,CAKE,SAACJ,KAAD,CAAW,CACT,GAAIA,KAAK,CAACG,QAAV,CAAoB,CAClB,OAAQH,KAAK,CAACG,QAAN,CAAeE,MAAvB,EACE,IAAK,IAAL,CACER,OAAO,CAACC,GAAR,CAAY,YAAZ,EACAQ,MAAM,CAACC,QAAP,CAAkB,QAAlB,CACA,MACF,QACEtB,OAAO,CAACe,KAAR,CAAcA,KAAK,CAACG,QAAN,CAAeC,IAAf,CAAoBI,QAAlC,CAA4C,CAA5C,EACA,MAPJ,CASD,CACDX,OAAO,CAACC,GAAR,CAAY,aAAZ,CAA2BE,KAAK,CAACG,QAAjC,EACA,MAAOF,CAAAA,OAAO,CAACC,MAAR,CAAeF,KAAK,CAACG,QAAN,CAAeC,IAA9B,CAAP,CACA;AACA;AACD,CArBH,EAuBA,cAAehB,CAAAA,QAAf","sourcesContent":["/*\n\nCopyright <holder> All Rights Reserved\n\nSPDX-License-Identifier: Apache-2.0\n\n*/\nimport { message } from \"antd\";\nimport axios from \"axios\";\nimport { getToken } from \"./auth\";\n\nconst instance = axios.create({\n  baseURL: \"https://cloudland.pic.cdl.ibm.com\",\n  timeout: 5000,\n  headers: {\n    \"Content-Type\": \"application/json;charset=UTF-8\",\n    \"Allow-Control-Allow-Origin\": \"*\",\n  },\n});\n//全局请求拦截，发送请求之前执行\ninstance.interceptors.request.use(\n  (config) => {\n    console.log(\"getToken():\", getToken());\n    if (getToken()) {\n      config.headers.common[\"X-Auth-Token\"] = getToken();\n    } else {\n      delete config.headers.common[\"x-auth-token\"];\n      // router.push({\n      //   name: \"login\",\n      // });\n    }\n\n    return config;\n  },\n  (error) => {\n    return Promise.reject(error);\n  }\n);\n//请求返回之后执行\ninstance.interceptors.response.use(\n  (response) => {\n    console.log(\"axios-response\", response);\n    return response.data;\n  },\n  (error) => {\n    if (error.response) {\n      switch (error.response.status) {\n        case 401:\n          console.log(\"Need Login\");\n          window.location = \"/login\";\n          break;\n        default:\n          message.error(error.response.data.ErrorMsg, 5);\n          break;\n      }\n    }\n    console.log(\"axios-error\", error.response);\n    return Promise.reject(error.response.data);\n    // console.log(\"axios-error\", error.response);\n    // return Promise.reject(error);\n  }\n);\nexport default instance;\n"]},"metadata":{},"sourceType":"module"}